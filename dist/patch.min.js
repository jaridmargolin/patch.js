!function(a,b){"function"==typeof define&&define.amd?define(["underscore"],function(c){return a.returnExportsGlobal=b(c)}):"object"==typeof exports?module.exports=b(require("underscore")):a.patch=b(a.underscore)}(this,function(a){var b;return b=function(){var b=a;return{store:{},add:function(a,c,d){return b.isArray(a)?void b.each(a,function(a){return this.patchObj(a,c,d)},this):this.patchObj(a,c,d)},patchObj:function(a,c,d){return b.isArray(d)?void b.each(d,function(b){return this.addPatch(a,c,b)},this):this.addPatch(a,c,d)},addPatch:function(a,b,c){var d=a[b],e=c(d);a[b]=e,this.store[b]=this.store[b]||[],this.store[b].push({obj:a,original:d})},remove:function(a,c){var d=this.store[c];return d?b.isArray(a)?void b.each(a,function(a){return this.removePatch(a,c,d)},this):this.removePatch(a,c,d):d},removePatch:function(a,b,c){for(var d=c.length-1,e=0;d>e;d--)if(c[d].obj=a)return a[b]=c[d].original,void c.splice(d,1)}}}({})});